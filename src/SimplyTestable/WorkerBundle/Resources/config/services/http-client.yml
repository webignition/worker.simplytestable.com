services:
  GuzzleHttp\HandlerStack:
    factory: 'SimplyTestable\WorkerBundle\Services\HttpHandlerStackFactory:create'

  Kevinrob\GuzzleCache\CacheMiddleware:
    factory: 'SimplyTestable\WorkerBundle\Services\HttpCacheMiddlewareFactory:create'

  webignition\HttpHistoryContainer\Container:

  SimplyTestable\WorkerBundle\Services\HttpClientService:
    arguments:
      - '%curl_options%'
      - '@GuzzleHttp\HandlerStack'
      - '@webignition\HttpHistoryContainer\Container'
      - '@SimplyTestable\WorkerBundle\Services\HttpRetryMiddleware'
      - '@Kevinrob\GuzzleCache\CacheMiddleware'

  GuzzleHttp\Client:
    factory: 'SimplyTestable\WorkerBundle\Services\HttpClientService:getHttpClient'
